"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[7730],{1914(e,n,s){s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"module-2-digital-twin/chapter-5-integration/ros2-messaging","title":"ROS 2 Messaging Integration","description":"Introduction to ROS 2 Messaging","source":"@site/docs/module-2-digital-twin/chapter-5-integration/ros2-messaging.md","sourceDirName":"module-2-digital-twin/chapter-5-integration","slug":"/module-2-digital-twin/chapter-5-integration/ros2-messaging","permalink":"/Book-Physical-AI-Humanoid-Robotics/docs/module-2-digital-twin/chapter-5-integration/ros2-messaging","draft":false,"unlisted":false,"editUrl":"https://github.com/Muhammad-Bilal-Hussain/Book-Physical-AI-Humanoid-Robotics/docs/module-2-digital-twin/chapter-5-integration/ros2-messaging.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Chapter 5: References and Citations","permalink":"/Book-Physical-AI-Humanoid-Robotics/docs/module-2-digital-twin/chapter-5-integration/references"},"next":{"title":"Content Validation: Flesch-Kincaid Grade Level Assessment","permalink":"/Book-Physical-AI-Humanoid-Robotics/docs/module-2-digital-twin/chapter-5-integration/validation-report"}}');var t=s(4848),r=s(8453);const l={},o="ROS 2 Messaging Integration",a={},c=[{value:"Introduction to ROS 2 Messaging",id:"introduction-to-ros-2-messaging",level:2},{value:"ROS 2 Architecture Overview",id:"ros-2-architecture-overview",level:2},{value:"Communication Patterns",id:"communication-patterns",level:3},{value:"Topics (Publish/Subscribe)",id:"topics-publishsubscribe",level:4},{value:"Services (Request/Response)",id:"services-requestresponse",level:4},{value:"Actions (Goal/Feedback/Result)",id:"actions-goalfeedbackresult",level:4},{value:"Core ROS 2 Messages for Simulation",id:"core-ros-2-messages-for-simulation",level:2},{value:"Standard Message Types",id:"standard-message-types",level:3},{value:"Sensor Data Messages",id:"sensor-data-messages",level:4},{value:"Geometry Messages",id:"geometry-messages",level:4},{value:"Standard Messages",id:"standard-messages",level:4},{value:"ROS 2 Topics in Simulation",id:"ros-2-topics-in-simulation",level:2},{value:"Essential Simulation Topics",id:"essential-simulation-topics",level:3},{value:"Joint State Management",id:"joint-state-management",level:4},{value:"Robot State Information",id:"robot-state-information",level:4},{value:"Sensor Data Streams",id:"sensor-data-streams",level:4},{value:"Control Commands",id:"control-commands",level:4},{value:"Quality of Service (QoS) Settings",id:"quality-of-service-qos-settings",level:3},{value:"Reliability",id:"reliability",level:4},{value:"Durability",id:"durability",level:4},{value:"Lifespan",id:"lifespan",level:4},{value:"ROS 2 Services in Simulation",id:"ros-2-services-in-simulation",level:2},{value:"Essential Simulation Services",id:"essential-simulation-services",level:3},{value:"Model Management",id:"model-management",level:4},{value:"Simulation Control",id:"simulation-control",level:4},{value:"Parameter Management",id:"parameter-management",level:4},{value:"ROS 2 Actions in Simulation",id:"ros-2-actions-in-simulation",level:2},{value:"Navigation Actions",id:"navigation-actions",level:3},{value:"Manipulation Actions",id:"manipulation-actions",level:3},{value:"Implementation Patterns",id:"implementation-patterns",level:2},{value:"Publisher Implementation",id:"publisher-implementation",level:3},{value:"C++ Publisher Example",id:"c-publisher-example",level:4},{value:"Python Publisher Example",id:"python-publisher-example",level:4},{value:"Subscriber Implementation",id:"subscriber-implementation",level:3},{value:"C++ Subscriber Example",id:"c-subscriber-example",level:4},{value:"Unity ROS Subscriber Example",id:"unity-ros-subscriber-example",level:4},{value:"Advanced Messaging Concepts",id:"advanced-messaging-concepts",level:2},{value:"Custom Message Types",id:"custom-message-types",level:3},{value:"Creating Custom Messages",id:"creating-custom-messages",level:4},{value:"Using Custom Messages",id:"using-custom-messages",level:4},{value:"Lifecycle Management",id:"lifecycle-management",level:3},{value:"Node Lifecycle",id:"node-lifecycle",level:4},{value:"Managing Node States",id:"managing-node-states",level:4},{value:"Performance Optimization",id:"performance-optimization",level:2},{value:"Message Efficiency",id:"message-efficiency",level:3},{value:"Message Size Reduction",id:"message-size-reduction",level:4},{value:"Network Optimization",id:"network-optimization",level:4},{value:"Quality of Service Tuning",id:"quality-of-service-tuning",level:3},{value:"High-Frequency Data (e.g., sensor data)",id:"high-frequency-data-eg-sensor-data",level:4},{value:"Critical Data (e.g., commands)",id:"critical-data-eg-commands",level:4},{value:"Troubleshooting Common Issues",id:"troubleshooting-common-issues",level:2},{value:"Message Loss",id:"message-loss",level:3},{value:"Timing Issues",id:"timing-issues",level:3},{value:"Type Mismatches",id:"type-mismatches",level:3},{value:"Integration with Simulation Systems",id:"integration-with-simulation-systems",level:2},{value:"Gazebo Integration",id:"gazebo-integration",level:3},{value:"Unity Integration",id:"unity-integration",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"ros-2-messaging-integration",children:"ROS 2 Messaging Integration"})}),"\n",(0,t.jsx)(n.h2,{id:"introduction-to-ros-2-messaging",children:"Introduction to ROS 2 Messaging"}),"\n",(0,t.jsx)(n.p,{children:"ROS 2 (Robot Operating System 2) provides the communication infrastructure that enables integration between Gazebo physics simulation, Unity visualization, and other robotic components. Understanding ROS 2 messaging is crucial for creating effective integrated simulation environments. This chapter explores the various messaging patterns, topics, services, and actions used in simulation environments."}),"\n",(0,t.jsx)(n.h2,{id:"ros-2-architecture-overview",children:"ROS 2 Architecture Overview"}),"\n",(0,t.jsx)(n.h3,{id:"communication-patterns",children:"Communication Patterns"}),"\n",(0,t.jsx)(n.h4,{id:"topics-publishsubscribe",children:"Topics (Publish/Subscribe)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Pattern"}),": One-to-many communication"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Use Case"}),": Continuous data streams (sensor data, joint states)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Characteristics"}),": Asynchronous, fire-and-forget"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Quality of Service"}),": Configurable reliability and durability"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"services-requestresponse",children:"Services (Request/Response)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Pattern"}),": One-to-one synchronous communication"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Use Case"}),": Actionable requests (spawning models, resetting simulation)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Characteristics"}),": Blocking until response received"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Quality of Service"}),": Request-response pattern"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"actions-goalfeedbackresult",children:"Actions (Goal/Feedback/Result)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Pattern"}),": Long-running tasks with feedback"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Use Case"}),": Navigation, trajectory execution"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Characteristics"}),": Goal-oriented with ongoing feedback"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Quality of Service"}),": Multi-message interaction pattern"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"core-ros-2-messages-for-simulation",children:"Core ROS 2 Messages for Simulation"}),"\n",(0,t.jsx)(n.h3,{id:"standard-message-types",children:"Standard Message Types"}),"\n",(0,t.jsx)(n.h4,{id:"sensor-data-messages",children:"Sensor Data Messages"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"sensor_msgs/JointState"})}),": Joint positions, velocities, and efforts"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"sensor_msgs/Image"})}),": Camera image data"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"sensor_msgs/LaserScan"})}),": LiDAR scan data"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"sensor_msgs/Imu"})}),": Inertial measurement unit data"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"sensor_msgs/PointCloud2"})}),": 3D point cloud data"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"geometry-messages",children:"Geometry Messages"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"geometry_msgs/Twist"})}),": Linear and angular velocities"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"geometry_msgs/Pose"})}),": Position and orientation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"geometry_msgs/TransformStamped"})}),": Coordinate transformations"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"geometry_msgs/Vector3"})}),": 3D vector data"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"standard-messages",children:"Standard Messages"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"std_msgs/String"})}),": Simple string data"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"std_msgs/Float64"})}),": Single floating-point value"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"std_msgs/Int32"})}),": Single integer value"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"builtin_interfaces/Time"})}),": Timestamp information"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"ros-2-topics-in-simulation",children:"ROS 2 Topics in Simulation"}),"\n",(0,t.jsx)(n.h3,{id:"essential-simulation-topics",children:"Essential Simulation Topics"}),"\n",(0,t.jsx)(n.h4,{id:"joint-state-management",children:"Joint State Management"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/joint_states"})}),": Published by Gazebo, subscribed by Unity"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Message Type"}),": ",(0,t.jsx)(n.code,{children:"sensor_msgs/JointState"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Frequency"}),": Typically 50-100 Hz"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Synchronize robot joint positions between systems"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"robot-state-information",children:"Robot State Information"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsxs)(n.strong,{children:[(0,t.jsx)(n.code,{children:"/tf"})," and ",(0,t.jsx)(n.code,{children:"/tf_static"})]}),": Transform relationships"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Message Type"}),": ",(0,t.jsx)(n.code,{children:"tf2_msgs/TFMessage"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Frequency"}),": Variable, depending on change rate"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Purpose"}),": Maintain coordinate frame relationships"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"sensor-data-streams",children:"Sensor Data Streams"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/camera/image_raw"})}),": Camera image data"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/scan"})}),": LiDAR scan data"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/imu/data"})}),": IMU measurements"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/odom"})}),": Odometry information"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"control-commands",children:"Control Commands"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/cmd_vel"})}),": Velocity commands for mobile robots"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/joint_commands"})}),": Joint position/velocity/effort commands"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/trajectory"})}),": Trajectory execution commands"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"quality-of-service-qos-settings",children:"Quality of Service (QoS) Settings"}),"\n",(0,t.jsx)(n.h4,{id:"reliability",children:"Reliability"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Reliable"}),": All messages guaranteed to be delivered"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Best Effort"}),": Messages may be dropped (suitable for sensor data)"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"durability",children:"Durability"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Transient Local"}),": Late-joining subscribers receive last message"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Volatile"}),": Only new messages sent to subscribers"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"lifespan",children:"Lifespan"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"History"}),": Keep all messages or only last N messages"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Depth"}),": Maximum number of messages to store"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"ros-2-services-in-simulation",children:"ROS 2 Services in Simulation"}),"\n",(0,t.jsx)(n.h3,{id:"essential-simulation-services",children:"Essential Simulation Services"}),"\n",(0,t.jsx)(n.h4,{id:"model-management",children:"Model Management"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/spawn_entity"})}),": Spawn new models in Gazebo"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/delete_entity"})}),": Remove models from Gazebo"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/get_entity_state"})}),": Query model state"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/set_entity_state"})}),": Set model state"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"simulation-control",children:"Simulation Control"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/reset_simulation"})}),": Reset entire simulation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/pause_physics"})}),": Pause physics simulation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/unpause_physics"})}),": Resume physics simulation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/set_physics_properties"})}),": Configure physics parameters"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"parameter-management",children:"Parameter Management"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/set_parameters"})}),": Set node parameters"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/get_parameters"})}),": Query node parameters"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/list_parameters"})}),": List available parameters"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"ros-2-actions-in-simulation",children:"ROS 2 Actions in Simulation"}),"\n",(0,t.jsx)(n.h3,{id:"navigation-actions",children:"Navigation Actions"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/navigate_to_pose"})}),": Navigate to specific pose"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/follow_waypoints"})}),": Follow a sequence of waypoints"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/compute_path_to_pose"})}),": Plan path to destination"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"manipulation-actions",children:"Manipulation Actions"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/follow_joint_trajectory"})}),": Execute joint trajectory"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/pick_and_place"})}),": Perform pick and place operation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:(0,t.jsx)(n.code,{children:"/move_group"})}),": Move robot arm to goal"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"implementation-patterns",children:"Implementation Patterns"}),"\n",(0,t.jsx)(n.h3,{id:"publisher-implementation",children:"Publisher Implementation"}),"\n",(0,t.jsx)(n.h4,{id:"c-publisher-example",children:"C++ Publisher Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'#include <rclcpp/rclcpp.hpp>\n#include <sensor_msgs/msg/joint_state.hpp>\n\nclass JointStatePublisher : public rclcpp::Node\n{\npublic:\n    JointStatePublisher() : Node("joint_state_publisher")\n    {\n        publisher_ = this->create_publisher<sensor_msgs::msg::JointState>(\n            "/joint_states", 10);\n        \n        timer_ = this->create_wall_timer(\n            std::chrono::milliseconds(10), // 100 Hz\n            std::bind(&JointStatePublisher::publish_joint_states, this));\n    }\n\nprivate:\n    void publish_joint_states()\n    {\n        auto msg = sensor_msgs::msg::JointState();\n        msg.header.stamp = this->now();\n        msg.header.frame_id = "base_link";\n        \n        // Set joint names\n        msg.name = {"joint1", "joint2", "joint3"};\n        \n        // Set joint positions\n        msg.position = {0.1, 0.2, 0.3};\n        \n        // Set joint velocities\n        msg.velocity = {0.0, 0.0, 0.0};\n        \n        // Set joint efforts\n        msg.effort = {0.0, 0.0, 0.0};\n        \n        publisher_->publish(msg);\n    }\n    \n    rclcpp::Publisher<sensor_msgs::msg::JointState>::SharedPtr publisher_;\n    rclcpp::TimerBase::SharedPtr timer_;\n};\n\nint main(int argc, char * argv[])\n{\n    rclcpp::init(argc, argv);\n    rclcpp::spin(std::make_shared<JointStatePublisher>());\n    rclcpp::shutdown();\n    return 0;\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"python-publisher-example",children:"Python Publisher Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import JointState\nfrom builtin_interfaces.msg import Time\nimport math\n\nclass JointStatePublisher(Node):\n    def __init__(self):\n        super().__init__('joint_state_publisher')\n        self.publisher = self.create_publisher(JointState, '/joint_states', 10)\n        timer_period = 0.01  # 100 Hz\n        self.timer = self.create_timer(timer_period, self.publish_joint_states)\n        self.i = 0\n\n    def publish_joint_states(self):\n        msg = JointState()\n        msg.header.stamp = self.get_clock().now().to_msg()\n        msg.header.frame_id = 'base_link'\n        \n        # Set joint names\n        msg.name = ['joint1', 'joint2', 'joint3']\n        \n        # Set joint positions with some oscillation\n        msg.position = [\n            math.sin(self.i * 0.1),\n            math.cos(self.i * 0.1) * 0.5,\n            math.sin(self.i * 0.05) * 0.3\n        ]\n        \n        # Set joint velocities\n        msg.velocity = [0.0, 0.0, 0.0]\n        \n        # Set joint efforts\n        msg.effort = [0.0, 0.0, 0.0]\n        \n        self.publisher.publish(msg)\n        self.i += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    joint_state_publisher = JointStatePublisher()\n    rclpy.spin(joint_state_publisher)\n    joint_state_publisher.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,t.jsx)(n.h3,{id:"subscriber-implementation",children:"Subscriber Implementation"}),"\n",(0,t.jsx)(n.h4,{id:"c-subscriber-example",children:"C++ Subscriber Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'#include <rclcpp/rclcpp.hpp>\n#include <sensor_msgs/msg/joint_state.hpp>\n\nclass JointStateSubscriber : public rclcpp::Node\n{\npublic:\n    JointStateSubscriber() : Node("joint_state_subscriber")\n    {\n        subscription_ = this->create_subscription<sensor_msgs::msg::JointState>(\n            "/joint_states",\n            rclcpp::QoS(10).reliable(),\n            std::bind(&JointStateSubscriber::topic_callback, this, std::placeholders::_1));\n    }\n\nprivate:\n    void topic_callback(const sensor_msgs::msg::JointState::SharedPtr msg)\n    {\n        RCLCPP_INFO(this->get_logger(), "Received joint states:");\n        for (size_t i = 0; i < msg->name.size(); ++i) {\n            RCLCPP_INFO(this->get_logger(), \n                "  %s: pos=%.3f, vel=%.3f, eff=%.3f", \n                msg->name[i].c_str(), \n                msg->position[i], \n                msg->velocity[i], \n                msg->effort[i]);\n        }\n    }\n    \n    rclcpp::Subscription<sensor_msgs::msg::JointState>::SharedPtr subscription_;\n};\n'})}),"\n",(0,t.jsx)(n.h4,{id:"unity-ros-subscriber-example",children:"Unity ROS Subscriber Example"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-csharp",children:'using UnityEngine;\nusing Unity.Robotics.ROSTCPConnector;\nusing Unity.Robotics.ROSTCPConnector.MessageTypes.Sensor_msgs;\n\npublic class JointStateSubscriber : MonoBehaviour\n{\n    [SerializeField]\n    private string topicName = "/joint_states";\n    \n    [SerializeField]\n    private GameObject[] jointObjects;\n    \n    void Start()\n    {\n        ROSConnection ros = ROSConnection.GetOrCreateInstance();\n        ros.Subscribe<JointStateMsg>(topicName, OnJointStateReceived);\n    }\n    \n    void OnJointStateReceived(JointStateMsg jointState)\n    {\n        // Update joint objects based on received joint states\n        for (int i = 0; i < jointState.name.Length && i < jointObjects.Length; i++)\n        {\n            int jointIndex = System.Array.IndexOf(jointState.name, jointObjects[i].name);\n            if (jointIndex >= 0)\n            {\n                float angle = (float)jointState.position[jointIndex];\n                jointObjects[i].transform.localRotation = \n                    Quaternion.Euler(0, angle * Mathf.Rad2Deg, 0);\n            }\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"advanced-messaging-concepts",children:"Advanced Messaging Concepts"}),"\n",(0,t.jsx)(n.h3,{id:"custom-message-types",children:"Custom Message Types"}),"\n",(0,t.jsx)(n.h4,{id:"creating-custom-messages",children:"Creating Custom Messages"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# custom_msgs/msg/SimulationState.msg\nstring simulation_name\nbool is_paused\nfloat64 simulation_time\nfloat64 real_time_factor\nint32 model_count\n"})}),"\n",(0,t.jsx)(n.h4,{id:"using-custom-messages",children:"Using Custom Messages"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"# Publisher\nfrom custom_msgs.msg import SimulationState\n\npublisher = node.create_publisher(SimulationState, '/simulation_state', 10)\n\nmsg = SimulationState()\nmsg.simulation_name = 'test_simulation'\nmsg.is_paused = False\nmsg.simulation_time = 10.5\nmsg.real_time_factor = 1.0\nmsg.model_count = 5\n\npublisher.publish(msg)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"lifecycle-management",children:"Lifecycle Management"}),"\n",(0,t.jsx)(n.h4,{id:"node-lifecycle",children:"Node Lifecycle"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Unconfigured"}),": Node created but not configured"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Inactive"}),": Configured but not active"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Active"}),": Fully operational"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Finalized"}),": Node destroyed"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"managing-node-states",children:"Managing Node States"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from rclpy.lifecycle import LifecycleNode\nfrom rclpy.lifecycle import TransitionCallbackReturn\n\nclass LifecycleJointStatePublisher(LifecycleNode):\n    def __init__(self):\n        super().__init__('lifecycle_joint_state_publisher')\n    \n    def on_configure(self, state):\n        self.get_logger().info(\"Configuring...\")\n        self.publisher = self.create_publisher(JointState, '/joint_states', 10)\n        return TransitionCallbackReturn.SUCCESS\n    \n    def on_activate(self, state):\n        self.get_logger().info(\"Activating...\")\n        self.timer = self.create_timer(0.01, self.publish_joint_states)\n        return TransitionCallbackReturn.SUCCESS\n"})}),"\n",(0,t.jsx)(n.h2,{id:"performance-optimization",children:"Performance Optimization"}),"\n",(0,t.jsx)(n.h3,{id:"message-efficiency",children:"Message Efficiency"}),"\n",(0,t.jsx)(n.h4,{id:"message-size-reduction",children:"Message Size Reduction"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Delta Encoding"}),": Send only changes from previous state"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Compression"}),": Compress large messages when possible"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Throttling"}),": Limit message frequency to necessary rates"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Aggregation"}),": Combine multiple small messages"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"network-optimization",children:"Network Optimization"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Local Communication"}),": Use shared memory for local nodes"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"DDS Configuration"}),": Optimize DDS settings for performance"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Topic Partitioning"}),": Separate high-frequency from low-frequency topics"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Connection Management"}),": Efficient connection handling"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"quality-of-service-tuning",children:"Quality of Service Tuning"}),"\n",(0,t.jsx)(n.h4,{id:"high-frequency-data-eg-sensor-data",children:"High-Frequency Data (e.g., sensor data)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, QoSDurabilityPolicy, QoSReliabilityPolicy\n\nsensor_qos = QoSProfile(\n    depth=1,  # Only keep the latest message\n    durability=QoSDurabilityPolicy.VOLATILE,\n    reliability=QoSReliabilityPolicy.BEST_EFFORT\n)\n"})}),"\n",(0,t.jsx)(n.h4,{id:"critical-data-eg-commands",children:"Critical Data (e.g., commands)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"command_qos = QoSProfile(\n    depth=10,  # Keep more messages\n    durability=QoSDurabilityPolicy.VOLATILE,\n    reliability=QoSReliabilityPolicy.RELIABLE\n)\n"})}),"\n",(0,t.jsx)(n.h2,{id:"troubleshooting-common-issues",children:"Troubleshooting Common Issues"}),"\n",(0,t.jsx)(n.h3,{id:"message-loss",children:"Message Loss"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Symptoms"}),": Missing messages or inconsistent data"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Causes"}),": Network congestion, insufficient buffer sizes"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Solutions"}),": Increase queue sizes, reduce frequency, improve network"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"timing-issues",children:"Timing Issues"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Symptoms"}),": Outdated or delayed messages"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Causes"}),": Slow processing, network latency"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Solutions"}),": Optimize processing, use appropriate QoS settings"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"type-mismatches",children:"Type Mismatches"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Symptoms"}),": Failed subscriptions or malformed data"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Causes"}),": Incorrect message types or versions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Solutions"}),": Verify message definitions, rebuild workspace"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"integration-with-simulation-systems",children:"Integration with Simulation Systems"}),"\n",(0,t.jsx)(n.h3,{id:"gazebo-integration",children:"Gazebo Integration"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Plugins"}),": Use Gazebo ROS 2 plugins for native integration"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Services"}),": Leverage Gazebo services for simulation control"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Topics"}),": Subscribe to Gazebo-published topics"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"unity-integration",children:"Unity Integration"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"ROS-TCP-Connector"}),": Use for Unity-ROS communication"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Message Serialization"}),": Efficient conversion between systems"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Threading"}),": Proper thread management for communication"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"ROS 2 messaging provides the essential communication infrastructure for integrated simulation environments. By understanding and properly implementing these messaging patterns, developers can create robust, efficient, and scalable simulation systems that effectively connect all components of their robotic simulation pipeline."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>l,x:()=>o});var i=s(6540);const t={},r=i.createContext(t);function l(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);